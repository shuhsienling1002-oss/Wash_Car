import streamlit as st

# ---------------------------------------------------------
# 1. æ¡ƒåœ’å…¨å€ç†±é–€åº—å®¶è³‡æ–™åº« (å·²å¹«æ‚¨æœé›† 20+ é–“é«˜è©•åƒ¹åå–®)
# ---------------------------------------------------------
shops_data = [
    # --- æ¡ƒåœ’å€ (Taoyuan District) ---
    {
        "name": "è»Šå®¹åŠåŠ æ²¹ç«™æ´—è»Š (æ˜¥æ—¥ç«™)",
        "district": "æ¡ƒåœ’å€",
        "location": "æ¡ƒåœ’å€æ˜¥æ—¥è·¯1000è™Ÿ",
        "type": "æ©Ÿå™¨æ´—è»Š+äººå·¥æ“¦æ‹­",
        "price": "ğŸ’° 150 - 250",
        "rating": 4.2,
        "desc": "æ˜¥æ—¥è·¯è»Šæµé‡å¤§ï¼Œé€™é–“é€Ÿåº¦å¿«ï¼Œéå¹´æ’éšŠå‹•ç·šé‚„ç®—é †æš¢ã€‚",
    },
    {
        "name": "IPO å°ˆæ¥­æ±½è»Šç¾å®¹ (æ¡ƒåœ’å¤§èˆˆåº—)",
        "district": "æ¡ƒåœ’å€",
        "location": "æ¡ƒåœ’å€å¤§èˆˆè¥¿è·¯äºŒæ®µ",
        "type": "é«˜éšéè†œ/æ·±å±¤è­·ç†",
        "price": "ğŸ’° 1500 - 5000",
        "rating": 4.8,
        "desc": "è—æ–‡ç‰¹å€ååº—ï¼Œé–‹é›™Bå›éƒ¨è½å¿…å»ï¼Œå»ºè­°æå‰å…©é€±é ç´„ã€‚",
    },
    {
        "name": "é­”æ³•æ³¡æ³¡è‡ªåŠ©æ´—è»Š (ç¶“åœ‹åº—)",
        "district": "æ¡ƒåœ’å€",
        "location": "æ¡ƒåœ’å€ç¶“åœ‹è·¯",
        "type": "24H è‡ªåŠ©æ´—è»Š",
        "price": "ğŸ’° 10å…ƒæŠ•å¹£å¼",
        "rating": 4.4,
        "desc": "å ´åœ°å¤§ã€æ°´å£“å¼·ï¼Œæ™šä¸Šå¾ˆå¤šæ”¹è£è»Šå‹èšæœƒï¼Œé©åˆå¹´è¼•æ—äººã€‚",
    },
    {
        "name": "K-WAX å‡±å¨è»Šè—",
        "district": "æ¡ƒåœ’å€",
        "location": "æ¡ƒåœ’å€æ–‡ä¸­è·¯",
        "type": "å°ˆæ¥­ç¾å®¹/ç”¢å“è²©å”®",
        "price": "ğŸ’° 800 - 3000",
        "rating": 4.9,
        "desc": "ç¶²è·¯ä¸Šå¾ˆæœ‰åçš„åº—ï¼Œä¹Ÿæœ‰è³£æ´—è»Šè—¥æ°´ï¼Œå¯ä»¥è²·ä¸€çµ„å¸¶å›èŠ±è“®ç”¨ã€‚",
    },

    # --- ä¸­å£¢å€ (Zhongli District) ---
    {
        "name": "è»Šå¤ªç‚«æŠ•å¹£å¼è‡ªåŠ©æ´—è»Š (ç’°åŒ—åº—)",
        "district": "ä¸­å£¢å€",
        "location": "ä¸­å£¢å€ç’°åŒ—è·¯",
        "type": "24H è‡ªåŠ©æ´—è»Š",
        "price": "ğŸ’° æŠ•å¹£/å„²å€¼å¡",
        "rating": 4.5,
        "desc": "ä¸­å£¢å¾ˆæœ‰åçš„è‡ªåŠ©æ´—ï¼Œè¨­å‚™ç¶­è­·å¾—å¾ˆå¥½ï¼Œæ³¡æ²«å¾ˆæ¿ƒã€‚",
    },
    {
        "name": "æ½”å…‰è»Šé«”éè†œç¾å®¹",
        "district": "ä¸­å£¢å€",
        "location": "ä¸­å£¢å€å»¶å¹³è·¯",
        "type": "ç²¾ç·»æ´—è»Š/éè†œ",
        "price": "ğŸ’° 1200 èµ·",
        "rating": 4.7,
        "desc": "è€é—†å¾ˆç´°å¿ƒï¼Œå…§è£æ¸…å¾—å¾ˆä¹¾æ·¨ï¼Œé©åˆæœ‰è¼‰å°å­©çš„å®¶åº­è»Šã€‚",
    },
    {
        "name": "Smile é€Ÿé‚æ¨‚ (ä¸­å£¢æœå‹™ä¸­å¿ƒ)",
        "district": "ä¸­å£¢å€",
        "location": "ä¸­å£¢å€ä¸­è¯è·¯",
        "type": "åŠ æ²¹ç«™ç²¾ç·»æ´—",
        "price": "ğŸ’° 200 - 500",
        "rating": 4.1,
        "desc": "çµ±ä¸€é›†åœ˜çš„ï¼Œå“è³ªç©©å®šï¼Œä¸æƒ³å»ç§äººåº—å®¶çš„å¥½é¸æ“‡ã€‚",
    },

    # --- å…«å¾·å€ (Bade District) ---
    {
        "name": "è»Šè»Šæ¾¡å ‚è‡ªåŠ©æ´—è»Š",
        "district": "å…«å¾·å€",
        "location": "å…«å¾·å€ä»‹å£½è·¯äºŒæ®µ",
        "type": "24H è‡ªåŠ©æ´—è»Š",
        "price": "ğŸ’° 20å…ƒèµ·",
        "rating": 4.3,
        "desc": "ä»‹å£½è·¯å¾€å¤§æºªæ–¹å‘ï¼Œå›é„‰é †è·¯æ´—ä¸€ä¸‹å‰›å¥½ã€‚",
    },
    {
        "name": "3M å°ˆæ¥­æ±½è»Šç¾å®¹ (å…«å¾·åº—)",
        "district": "å…«å¾·å€",
        "location": "å…«å¾·å€ç¾©å‹‡è¡—",
        "type": "æ¨™æº–ç¾å®¹",
        "price": "ğŸ’° 800 - 2000",
        "rating": 4.5,
        "desc": "è€ç‰Œå­æŠ€è¡“ç©©ï¼Œé™¤æŸæ²¹å’Œéµç²‰å¾ˆå²å®³ã€‚",
    },

    # --- è˜†ç«¹/å—å´ (Luzhu District) ---
    {
        "name": "éº—é‰…å°ˆæ¥­æ±½è»Šç¾å®¹ (å—å´ç¸½åº—)",
        "district": "è˜†ç«¹å€",
        "location": "è˜†ç«¹å€å—å´è·¯ä¸€æ®µ",
        "type": "é ‚ç´šè­·ç†",
        "price": "ğŸ’° 2000+",
        "rating": 4.8,
        "desc": "å—å´è©•åƒ¹æœ€é«˜çš„åº—ä¹‹ä¸€ï¼Œå¾ˆå¤šæ©Ÿå¸«ç©ºå§çš„è»Šéƒ½åœ¨é€™æ´—ã€‚",
    },
    {
        "name": "æ´—è»Šç‹åœ‹ (å—å·¥åº—)",
        "district": "è˜†ç«¹å€",
        "location": "è˜†ç«¹å€å—å·¥è·¯",
        "type": "è‡ªåŠ©æ´—è»Š",
        "price": "ğŸ’° æŠ•å¹£å¼",
        "rating": 4.2,
        "desc": "é è¿‘å·¥æ¥­å€ï¼Œå ´åœ°éå¸¸å¤§ï¼Œéå¹´æœŸé–“ä¸æ€•æ²’ä½å­ã€‚",
    },

    # --- é¾œå±±/æ—å£ (Guishan District) ---
    {
        "name": "G'ZOX æ—¥æœ¬é ‚ç´šæ±½è»Šç¾å®¹ (æ—å£åº—)",
        "district": "é¾œå±±å€",
        "location": "é¾œå±±å€æ–‡åŒ–ä¸‰è·¯",
        "type": "æ—¥æœ¬éè†œ",
        "price": "ğŸ’° 3000+",
        "rating": 4.9,
        "desc": "æ—¥æœ¬ç¬¬ä¸€å“ç‰Œï¼Œåšå®Œæ½‘æ°´æ€§è¶…å¼·ï¼Œè·‘è˜‡èŠ±å…¬è·¯ä¸‹é›¨ä¹Ÿä¸æ€•ã€‚",
    },
    {
        "name": "å¤§é­¯é–£å¡ä¸è»Šå ´æ—è‡ªåŠ©æ´—",
        "district": "æ¡ƒåœ’å€", # äº¤ç•Œè™•
        "location": "æ¡ƒåœ’å€ä¸­æ­£è·¯",
        "type": "è‡ªåŠ©æ´—è»Š",
        "price": "ğŸ’° æŠ•å¹£å¼",
        "rating": 4.3,
        "desc": "é›¢äº¤æµé“è¿‘ï¼Œä¸Šé«˜é€Ÿå…¬è·¯å‰æœ€å¾Œæ•´ç†çš„å¥½åœ°æ–¹ã€‚",
    },

    # --- å¹³é®å€ (Pingzhen District) ---
    {
        "name": "é­”æ³•è»Šé«”ç¾ç ”",
        "district": "å¹³é®å€",
        "location": "å¹³é®å€ç’°å—è·¯",
        "type": "ç²¾ç·»è­·ç†",
        "price": "ğŸ’° 600 - 1500",
        "rating": 4.6,
        "desc": "ç’°å—è·¯ä¸Šä¸€æ•´æ’æ´—è»Šåº—è£¡è©•åƒ¹æœ€å¥½çš„ã€‚",
    },
    {
        "name": "ç‰¹éº—è‡ªåŠ©æ´—è»Š (å¹³é®åº—)",
        "district": "å¹³é®å€",
        "location": "å¹³é®å€ä¸­è±è·¯",
        "type": "è‡ªåŠ©æ´—è»Š",
        "price": "ğŸ’° æŠ•å¹£å¼",
        "rating": 4.4,
        "desc": "ä¸­è±è·¯å¾€é¾æ½­æ–¹å‘ï¼Œå‹•ç·šå¯¬æ•ã€‚",
    }
]

# ---------------------------------------------------------
# 2. App ä¸»ç¨‹å¼
# ---------------------------------------------------------
st.set_page_config(page_title="æ¡ƒåœ’ä¸‰ä¸€å”æœƒ - è¿”é„‰æ„›è»Šç‰¹æœ", page_icon="ğŸš™", layout="centered")

# æ¨™é¡Œå€
st.title("ğŸš™ æ¡ƒåœ’ä¸‰ä¸€å”æœƒï¼šè¿”é„‰æ„›è»Šç‰¹æœ")
st.markdown(
    """
    <div style="background-color: #1565C0; padding: 15px; border-radius: 10px; color: white; margin-bottom: 20px;">
        <strong>Nga'ay ho! æ¡ƒåœ’å…¨å€æ´—è»Šåå–®å¤§æ•´ç†</strong><br>
        é€™è£¡å¹«å¤§å®¶æ•´ç†äº†æ¡ƒåœ’ã€ä¸­å£¢ã€å…«å¾·ç­‰åœ°è©•åƒ¹æœ€å¥½çš„åº—å®¶ã€‚<br>
        ä¸è«–æ˜¯æƒ³çœéŒ¢è‡ªå·±æ´—ï¼Œé‚„æ˜¯èŠ±éŒ¢å¤§ç¾å®¹ï¼Œé€™è£¡éƒ½æœ‰ï¼
    </div>
    """, 
    unsafe_allow_html=True
)

# --- å´é‚Šæ¬„ï¼šé€²éšç¯©é¸ ---
with st.sidebar:
    st.header("ğŸ” é€²éšæœå°‹")
    search_keyword = st.text_input("è¼¸å…¥åº—åé—œéµå­—", placeholder="ä¾‹å¦‚ï¼šè‡ªåŠ©ã€éè†œ...")
    
    st.divider()
    st.write("éæ¿¾åƒ¹æ ¼å€é–“ï¼š")
    price_filter = st.select_slider(
        "é ç®—ç¯„åœ",
        options=["éŠ…æ¿åƒ¹ (è‡ªåŠ©)", "å°è³‡ (500å…§)", "ç²¾ç·» (1500å…§)", "é ‚ç´š (2000+)"],
        value="éŠ…æ¿åƒ¹ (è‡ªåŠ©)"
    )

# --- ä¸»ç•«é¢ï¼šå€åŸŸç¯©é¸ ---
st.write("### ğŸ‘‡ æ‚¨ä½å“ªä¸€å€ï¼Ÿ")
# æŠ“å–è³‡æ–™åº«ä¸­æ‰€æœ‰çš„å€åŸŸ
all_districts = sorted(list(set([shop["district"] for shop in shops_data])))
all_districts.insert(0, "å…¨éƒ¨é¡¯ç¤º")

# ä½¿ç”¨è—¥ä¸¸ç‹€æŒ‰éˆ•
selected_area = st.pills("å€åŸŸåˆ‡æ›", all_districts, selection_mode="single", default="å…¨éƒ¨é¡¯ç¤º")

st.divider()

# --- æ ¸å¿ƒç¯©é¸é‚è¼¯ ---
filtered_shops = []
for shop in shops_data:
    # 1. å€åŸŸç¯©é¸
    if selected_area != "å…¨éƒ¨é¡¯ç¤º" and shop["district"] != selected_area:
        continue
    # 2. é—œéµå­—ç¯©é¸
    if search_keyword and search_keyword not in shop["name"] and search_keyword not in shop["type"]:
        continue
    
    filtered_shops.append(shop)

# --- é¡¯ç¤ºçµæœ ---
st.caption(f"ç›®å‰é¡¯ç¤º {len(filtered_shops)} é–“å„ªè³ªåº—å®¶")

if not filtered_shops:
    st.warning("âš ï¸ æ‰¾ä¸åˆ°ç¬¦åˆæ¢ä»¶çš„åº—å®¶ï¼Œè«‹å˜—è©¦åˆ‡æ›å€åŸŸæˆ–æ¸…é™¤é—œéµå­—ã€‚")

for shop in filtered_shops:
    with st.container(border=True):
        col1, col2 = st.columns([7, 3])
        
        with col1:
            # æ¨™é¡Œèˆ‡å€åŸŸæ¨™ç±¤
            st.subheader(f"{shop['name']}")
            st.caption(f"ğŸ“ {shop['district']} | {shop['type']}")
            
            # åƒ¹æ ¼èˆ‡æè¿°
            st.markdown(f"**{shop['price']}**")
            st.write(f"ğŸ’¬ {shop['desc']}")
            
        with col2:
            # è©•åˆ†å¤§å­—é¡¯ç¤º
            st.markdown(f"<h2 style='text-align:center; color:#FFC107; margin:0;'>â˜… {shop['rating']}</h2>", unsafe_allow_html=True)
            
            st.write("") # ç©ºè¡Œ
            
            # å°èˆªæŒ‰éˆ•
            map_url = f"https://www.google.com/maps/search/?api=1&query={shop['name']}+{shop['location']}"
            st.link_button("ğŸš— å°èˆªå»", map_url, use_container_width=True, type="primary")

# --- åº•éƒ¨ ---
st.divider()
st.markdown(
    "<div style='text-align: center; color: #888;'>æ¡ƒåœ’ä¸‰ä¸€å”æœƒ Taoyuan Sanyi Association Â© 2026<br>è³‡æ–™ä¾†æºï¼šGoogle Maps ç†±é–€è©•åƒ¹æ•´ç†</div>", 
    unsafe_allow_html=True
)
